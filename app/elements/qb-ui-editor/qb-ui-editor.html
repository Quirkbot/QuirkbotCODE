<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/paper-drawer-panel/paper-drawer-panel.html">

<link rel="import" href="../qb-ui-editor-visual/qb-ui-editor-visual.html">
<link rel="import" href="../qb-ui-nodes-menu/qb-ui-nodes-menu.html">

<dom-module id='qb-ui-editor'>
	<style>
		:host{
			display: block;
		}
		.paper-drawer-panel,
		.editor{
			width: 100%;
			height: 100%;
		}

		*{
			-webkit-user-select: none;
			-khtml-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
		}

	</style>

	<template>

		<paper-drawer-panel
			right-drawer>
			<qb-ui-nodes-menu
				drawer
				id="menu"
				visual-editor="{{visualEditor}}"
				text-editor="{{textEditor}}"
				model="{{model}}"
				model-controller="{{modelController}}"
				node-definitions="{{nodeDefinitions}}"
				taxonomy-definitions="{{taxonomyDefinitions}}">
			</qb-ui-nodes-menu>
			<div
				id="dropArea"
				main>
				<template is="dom-if" if="{{visualMode}}">
					<qb-ui-editor-visual
						class="editor"
						self="{{visualEditor}}"
						model="{{model}}"
						model-controller="{{modelController}}"
						node-definitions="{{nodeDefinitions}}"
						constant-definitions="{{constantDefinitions}}">
					</qb-ui-editor-visual>
				</template>
				<template is="dom-if" if="{{textlMode}}">
					<qb-ui-editor-text
						class="editor"
						self="{{textEditor}}"
						model="{{model}}"
						model-controller="{{modelController}}"
						node-definitions="{{nodeDefinitions}}"
						constant-definitions="{{constantDefinitions}}">
					</qb-ui-editor-text>
				</template>
			</div>
		</paper-drawer-panel>
	</template>
</dom-module>
<script>
(function () {
	window.Quirkbot = window.Quirkbot || {};
	window.Quirkbot.UIEditor = Polymer({
		is: 'qb-ui-editor',
		properties: {
			model:{
				type: Object
			},
			modelController:{
				type: Object
			},
			nodeDefinitions: {
				type: Object
			},
			constantDefinitions: {
				type: Object
			},
			taxonomyDefinitions: {
				type: Object
			},
			mode:{
				type: String,
				value: 'visual',
				notify: true,
				observer: '_modeChanged'
			},
			visualEditor:{
				type: Object
			},
			textEditor:{
				type: Object
			},
			visualMode: {
				type: Boolean
			},
			textMode: {
				type: Boolean
			}
		},
		_modeChanged: function (mode) {
			if(mode === 'text'){
				this.textMode = true;
				this.visualMode = false;
			}
			else {
				this.textMode = false;
				this.visualMode = true;
			}
		},
		attached: function () {
			this.$.menu.dropArea = this.$.dropArea;
		}
	});
})();
</script>
