<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../bower_components/paper-styles/paper-styles.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">

<link rel="import" href="../qb-core-i18n/qb-core-i18n.html">
<link rel="import" href="../qb-core-router/qb-core-router.html">
<link rel="import" href="../qb-core-node-definitions/qb-core-node-definitions.html">
<link rel="import" href="../qb-core-model-controller/qb-core-model-controller.html">
<link rel="import" href="../qb-core-tree-manager/qb-core-tree-manager.html">

<link rel="import" href="../qb-ui-styles/qb-ui-styles.html">
<link rel="import" href="../qb-ui-editor/qb-ui-editor.html">
<link rel="import" href="../qb-ui-quirkbots-area/qb-ui-quirkbots-area.html">

<!-- Platinum elements -->
<!--
<link rel="import" href="../bower_components/platinum-sw/platinum-sw-cache.html">
<link rel="import" href="../bower_components/platinum-sw/platinum-sw-register.html">
-->

<dom-module id='qb-ide'>
	<style>
		:host{
			display: block;
			width: 100%;
			height: 100%;
		}

	</style>
	<template>

		<qb-core-i18n
			url-format="{{stringsUrl}}"
			locale="{{locale}}">
		</qb-core-i18n>


		<qb-core-node-definitions
			url="{{nodesUrl}}"
			nodes="{{nodeDefinitions}}"
			groups="{{groupDefinitions}}"
			constants="{{constantDefinitions}}"
			taxonomies="{{taxonomyDefinitions}}">
		</qb-core-node-definitions>

		<qb-core-model-controller
			_id="{{programId}}"
			api="{{programsApiUrl}}"
			self="{{modelController}}"
			model="{{model}}"
			verbose="error">
		</qb-core-model-controller>

		<qb-core-tree-manager
			self="{{treeManager}}"
			compiler-url="{{compilerUrl}}"
			computed-code="{{computedCode}}"
			model-controller="{{modelController}}"
			model="{{model}}"
			node-definitions="{{nodeDefinitions}}"
			constant-definitions="{{constantDefinitions}}">
		</qb-core-tree-manager>

		<qb-ui-quirkbots-area
			self="{{quirkbotsArea}}"
			chrome-webstore-id="{{chromeWebstoreId}}"
			tree-manager="{{treeManager}}">
		</qb-ui-quirkbots-area>

		<paper-header-panel mode="seamed">

			<paper-toolbar>

				<paper-radio-group selected="{{editorMode}}">
					<paper-radio-button name="visual">
						<qb-core-i18n key="ide/editor/visual"></qb-core-i18n>
					</paper-radio-button>
					<paper-radio-button name="text">
						<qb-core-i18n key="ide/editor/text"></qb-core-i18n>
					</paper-radio-button>
				</paper-radio-group>

				<paper-button
					on-tap="_onUploadButtonTap">
					<qb-core-i18n key="ide/quirkbots-area/open-button"></qb-core-i18n>
				</paper-button>

			</paper-toolbar>

			<qb-ui-editor
				class="fit"
				mode={{editorMode}}
				model="{{model}}"
				model-controller="{{modelController}}"
				tree-manager="{{treeManager}}"
				computed-code="{{computedCode}}"
				node-definitions="{{nodeDefinitions}}"
				constant-definitions="{{constantDefinitions}}"
				taxonomy-definitions="{{taxonomyDefinitions}}">
			</qb-ui-editor>

		</paper-header-panel>

	</template>
</dom-module>

<script>
(function () {
	window.Quirkbot = window.Quirkbot || {};
	window.Quirkbot.Ide = Polymer({
		is: 'qb-ide',
		properties: {
			programId: String,
			locale: {
				type: String,
				value: 'en_US'
			},
			programsApiUrl: {
				type: String,
				value: 'http://localhost:8585/api/programs/'
			},
			compilerUrl: {
				type: String,
				value: 'https://quirkbot-compiler.herokuapp.com/'
			},
			nodesUrl: {
				type: String,
				value: 'data/nodes.json'
			},
			stringsUrl: {
				type: String,
				value: 'data/strings/{{locale}}.json'
			},
			chromeWebstoreId: {
				type: String,
				value: 'ackaalhbfjagidmjlhlokoblhbnahegd'
			},
			modelController: Object,
			model: Object,
			treeManager: Object,
			nodeDefinitions: Array,
			constantDefinitions: Array,
			taxonomyDefinitions: Object,
			editorMode: String,
			quirkbotsArea: Object,
		},
		_onUploadButtonTap: function(){
			this.quirkbotsArea.open();
		}
	});
})();
</script>
