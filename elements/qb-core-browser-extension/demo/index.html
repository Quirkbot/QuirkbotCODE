<!doctype html>
<html>
<head>

	<script src="../../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
	<link rel="import" href="../../qb-core-browser-extension/qb-core-browser-extension.html">

</head>
<body>

	<dom-module	id="qb-app">
		<template>
			<qb-core-browser-extension
				id="qb-core-browser-extension"
				model="{{model}}"
				connected="{{connected}}"
				extensionId="{{extensionId}}"
				>
			</qb-core-browser-extension>

			<div>
				<div hidden="{{connected}}">
					Not Connected to extension.
				</div>
				<div hidden="{{!connected}}">
					Connected to extension.

					<button on-click="compile">Compile</button>

					<template is="x-repeat" items="{{model.quirkbots}}">
						<h1>Quirkbot</h1>
						<p><b>UUID: </b>{{item.uuid}}</p>

						<h2>Nodes</h2>
						<span>
						<template is="x-repeat" items="{{item.nodes}}">
							<p>{{item}}</p>						
						</template>
						</span>

						<span hidden="{{!item.upload.pending}}">
							<h2>Uploading</h2>
						</span>
					</template>
					
				</div>
				
			</div>
		</template>
	</dom-module>
	<script>
		(function () {
			Polymer({
				is: 'qb-app',
				created: function(){
					
				},
				compile:  function(){
					var start = Date.now();
					var browserExtension = document.getElementById('qb-core-browser-extension');
					browserExtension.compile('#include "Quirkbot.h"\nLed led; Wave wave; ServoMotor servo; List l; void start(){};')
					.then(function (result) {
						console.log(Date.now() - start, result)
					})
				}
			});
		})();
	</script>
	<qb-app></qb-app>
</body>
</html>